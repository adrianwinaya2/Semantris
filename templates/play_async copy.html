<!DOCTYPE html>
<html>
<head>
    <title>Play</title>

    <style>
        .target {
            color: red;
        }
    </style>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            // Function to update the game interface with the response data
            function updateGameInterface(response) {
                $('#score').text(response.score);
                $('#target').text(response.target);
                var wordsHtml = '';
                response.words.forEach(function(word) {
                    if (word.toLowerCase() === response.target.toLowerCase()) {
                        wordsHtml += '<li class="target">' + word + '</li>';
                    } else {
                        wordsHtml += '<li>' + word + '</li>';
                    }
                });
                $('#words').html(wordsHtml);
                if (response.error) {
                    $('#error').text(response.error);
                } else {
                    $('#error').text('');
                }
            }
    
            // Function to handle the check request
            function checkAnswer(answer) {
                $.ajax({
                    url: '/check',
                    type: 'POST',
                    data: {
                        answer: answer,
                    },
                    success: function(response) {
                        updateGameInterface(response);
                    },
                    error: function() {
                        console.log('Error occurred during check request.');
                    }
                });
            }
    
            // Event listener for the submit button
            $('#submit-btn').click(function(e) {
                e.preventDefault();
                var answer = $('#answer').val();
                checkAnswer(answer);
    
                // Clear the answer text field
                $('#answer').val('');
    
                // Turn off autocomplete/recommendations for the answer field
                $('#answer').attr('autocomplete', 'off');
                $('#answer').attr('autocorrect', 'off');
                $('#answer').attr('autocapitalize', 'off');
                $('#answer').attr('spellcheck', 'false');
            });
        });
    </script>
    
</head>
<body>
    <h1>Play</h1>
    <p>Score: <span id="score">{{ session.score }}</span></p>
    <p>Target: <span id="target">{{ session.target }}</span></p>
    <ul id="words">
        {% for word in session.words %}
            <li {% if word == session.target %}class="target"{% endif %}>{{ word }}</li>
        {% endfor %}
    </ul>
    
    {% if session.error %}
        <p>{{ session.error }}</p>
    {% endif %}

    <form>
        <label for="answer">Answer:</label>
        <input type="text" id="answer" name="answer" autofocus>
        <button type="submit" id="submit-btn">Check</button>
    </form>
</body>
</html>
